{* Hub Comment - –®–∞–±–ª–æ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è Hub –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è *}
{strip}
<div class="hub-comment" data-comment-id="{$comment.id}">
    <div class="hub-comment__header">
        {* –ê–≤–∞—Ç–∞—Ä –∞–≤—Ç–æ—Ä–∞ *}
        <div class="hub-comment__avatar">
            {if !empty($comment.author.photo_url)}
                <img src="{$comment.author.photo_url}" alt="{$comment.author.name|escape}" class="hub-comment__avatar-img">
            {else}
                <div class="hub-comment__avatar-placeholder">
                    {$comment.author.name|substr:0:1|upper}
                </div>
            {/if}
        </div>
        
        {* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ *}
        <div class="hub-comment__author">
            <a href="{$wa->getUrl('hub/frontend/author')}/{$comment.contact_id}/" class="hub-comment__author-link">
                {$comment.author.name|default:$comment.author.login|escape}
            </a>
            {if !empty($comment.author.badge)}
                <span class="hub-comment__author-badge">{$comment.author.badge|escape}</span>
            {/if}
        </div>
        
        {* –î–∞—Ç–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è *}
        <div class="hub-comment__date">
            {$comment.datetime|wa_datetime:"humandatetime"}
        </div>
        
        {* –î–µ–π—Å—Ç–≤–∏—è —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º *}
        {if $wa->isAuth()}
            <div class="hub-comment__actions">
                {* –õ–∞–π–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è *}
                <button class="hub-comment__action hub-comment__action--like" data-comment-id="{$comment.id}">
                    <span class="hub-comment__action-icon">üëç</span>
                    {if !empty($comment.likes_count)}
                        <span class="hub-comment__action-count">{$comment.likes_count}</span>
                    {/if}
                </button>
                
                {* –û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π *}
                <button class="hub-comment__action hub-comment__action--reply" data-comment-id="{$comment.id}">
                    <span class="hub-comment__action-icon">üí¨</span>
                    <span class="hub-comment__action-text">{_w("Reply")}</span>
                </button>
                
                {* –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∞) *}
                {if $wa->userId() == $comment.contact_id}
                    <button class="hub-comment__action hub-comment__action--edit" data-comment-id="{$comment.id}">
                        <span class="hub-comment__action-icon">‚úèÔ∏è</span>
                    </button>
                    <button class="hub-comment__action hub-comment__action--delete" data-comment-id="{$comment.id}">
                        <span class="hub-comment__action-icon">üóëÔ∏è</span>
                    </button>
                {/if}
            </div>
        {/if}
    </div>
    
    {* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è *}
    <div class="hub-comment__content">
        {if !empty($comment.text)}
            <div class="hub-comment__text">
                {$comment.text}
            </div>
        {/if}
        
        {* –í–ª–æ–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å) *}
        {if !empty($comment.attachments)}
            <div class="hub-comment__attachments">
                {foreach $comment.attachments as $attachment}
                    <div class="hub-comment__attachment">
                        <a href="{$attachment.url}" class="hub-comment__attachment-link" target="_blank">
                            üìé {$attachment.name|escape}
                        </a>
                    </div>
                {/foreach}
            </div>
        {/if}
    </div>
    
    {* –§–æ—Ä–º–∞ –æ—Ç–≤–µ—Ç–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) *}
    {if $wa->isAuth()}
        <div class="hub-comment__reply-form" style="display: none;">
            <form action="{$wa->getUrl('hub/frontend/comment/add')}" method="post" class="hub-comment-reply-form">
                <input type="hidden" name="topic_id" value="{$comment.topic_id}">
                <input type="hidden" name="parent_id" value="{$comment.id}">
                <input type="hidden" name="csrf_token" value="{$wa->csrf()}">
                
                <div class="hub-comment-reply-form__field">
                    <textarea name="text" class="hub-comment-reply-form__textarea" placeholder="{_w('Write your reply...')}" required></textarea>
                </div>
                
                <div class="hub-comment-reply-form__actions">
                    <button type="submit" class="hub-comment-reply-form__submit">{_w("Reply")}</button>
                    <button type="button" class="hub-comment-reply-form__cancel">{_w("Cancel")}</button>
                </div>
            </form>
        </div>
    {/if}
    
    {* –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ *}
    {if !empty($comment.children)}
        <div class="hub-comment__replies">
            {foreach $comment.children as $reply}
                {include file="./comment.html" comment=$reply inline}
            {/foreach}
        </div>
    {/if}
</div>
{/strip} 